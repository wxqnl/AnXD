{"ast":null,"code":"import { reactive, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter, useRoute } from 'vue-router';\nimport { ElMessage } from 'element-plus';\n\n// 创建表单引用\n\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const loginFormRef = ref(null);\n    // 使用store\n    const store = useStore();\n    // 使用路由\n    const router = useRouter();\n    const route = useRoute();\n\n    // 登录表单数据\n    const loginForm = reactive({\n      username: '',\n      password: ''\n    });\n\n    // 表单验证规则\n    const loginRules = {\n      username: [{\n        required: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 20,\n        message: '长度在 3 到 20 个字符',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 6,\n        max: 20,\n        message: '长度在 6 到 20 个字符',\n        trigger: 'blur'\n      }]\n    };\n\n    // 登录状态\n    const loading = ref(false);\n\n    // 登录处理\n    const handleLogin = async () => {\n      // 验证表单\n      if (!loginFormRef.value) return;\n      await loginFormRef.value.validate(async valid => {\n        if (valid) {\n          try {\n            loading.value = true;\n            await store.dispatch('user/login', loginForm);\n            await store.dispatch('user/getUserInfo');\n            ElMessage({\n              message: '登录成功',\n              type: 'success'\n            });\n\n            // 重定向到首页或之前尝试访问的页面\n            router.push(route.query.redirect || '/');\n          } catch (error) {\n            ElMessage.error(error.message || '登录失败，请重试');\n          } finally {\n            loading.value = false;\n          }\n        } else {\n          return false;\n        }\n      });\n    };\n    const __returned__ = {\n      loginFormRef,\n      store,\n      router,\n      route,\n      loginForm,\n      loginRules,\n      loading,\n      handleLogin,\n      reactive,\n      ref,\n      useStore,\n      useRouter,\n      useRoute,\n      ElMessage\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","ref","useStore","useRouter","useRoute","ElMessage","loginFormRef","store","router","route","loginForm","username","password","loginRules","required","message","trigger","min","max","loading","handleLogin","value","validate","valid","dispatch","type","push","query","redirect","error"],"sources":["D:/javacode/daijiaUIChange/frontui/src/pages/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-card class=\"login-card\">\n      <div class=\"title\">\n        <h2>代驾管理系统</h2>\n      </div>\n      <el-form :model=\"loginForm\" :rules=\"loginRules\" ref=\"loginFormRef\" class=\"login-form\">\n        <el-form-item prop=\"username\">\n          <el-input v-model=\"loginForm.username\" prefix-icon=\"User\" placeholder=\"请输入用户名\" />\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input v-model=\"loginForm.password\" prefix-icon=\"Lock\" type=\"password\" placeholder=\"请输入密码\" show-password />\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" class=\"login-button\" :loading=\"loading\" @click=\"handleLogin\">登录</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { reactive, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { ElMessage } from 'element-plus'\n\n// 创建表单引用\nconst loginFormRef = ref(null)\n// 使用store\nconst store = useStore()\n// 使用路由\nconst router = useRouter()\nconst route = useRoute()\n\n// 登录表单数据\nconst loginForm = reactive({\n  username: '',\n  password: ''\n})\n\n// 表单验证规则\nconst loginRules = {\n  username: [\n    { required: true, message: '请输入用户名', trigger: 'blur' },\n    { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }\n  ],\n  password: [\n    { required: true, message: '请输入密码', trigger: 'blur' },\n    { min: 6, max: 20, message: '长度在 6 到 20 个字符', trigger: 'blur' }\n  ]\n}\n\n// 登录状态\nconst loading = ref(false)\n\n// 登录处理\nconst handleLogin = async () => {\n  // 验证表单\n  if (!loginFormRef.value) return\n  \n  await loginFormRef.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        loading.value = true\n        await store.dispatch('user/login', loginForm)\n        await store.dispatch('user/getUserInfo')\n        \n        ElMessage({\n          message: '登录成功',\n          type: 'success'\n        })\n        \n        // 重定向到首页或之前尝试访问的页面\n        router.push(route.query.redirect || '/')\n      } catch (error) {\n        ElMessage.error(error.message || '登录失败，请重试')\n      } finally {\n        loading.value = false\n      }\n    } else {\n      return false\n    }\n  })\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  background-color: #f0f2f5;\n}\n\n.login-card {\n  width: 400px;\n  padding: 20px 30px;\n  border-radius: 8px;\n}\n\n.title {\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.title h2 {\n  font-weight: 600;\n  color: #409EFF;\n  margin: 0;\n}\n\n.login-form {\n  margin-top: 30px;\n}\n\n.login-button {\n  width: 100%;\n}\n</style> "],"mappings":"AAsBA,SAASA,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AACnC,SAASC,QAAQ,QAAQ,MAAM;AAC/B,SAASC,SAAS,EAAEC,QAAQ,QAAQ,YAAY;AAChD,SAASC,SAAS,QAAQ,cAAc;;AAExC;;;;;;;IACA,MAAMC,YAAY,GAAGL,GAAG,CAAC,IAAI,CAAC;IAC9B;IACA,MAAMM,KAAK,GAAGL,QAAQ,CAAC,CAAC;IACxB;IACA,MAAMM,MAAM,GAAGL,SAAS,CAAC,CAAC;IAC1B,MAAMM,KAAK,GAAGL,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMM,SAAS,GAAGV,QAAQ,CAAC;MACzBW,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACZ,CAAC,CAAC;;IAEF;IACA,MAAMC,UAAU,GAAG;MACjBF,QAAQ,EAAE,CACR;QAAEG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO,CAAC,EACtD;QAAEC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,gBAAgB;QAAEC,OAAO,EAAE;MAAO,CAAC,CAChE;MACDJ,QAAQ,EAAE,CACR;QAAEE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAO,CAAC,EACrD;QAAEC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,gBAAgB;QAAEC,OAAO,EAAE;MAAO,CAAC;IAEnE,CAAC;;IAED;IACA,MAAMG,OAAO,GAAGlB,GAAG,CAAC,KAAK,CAAC;;IAE1B;IACA,MAAMmB,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B;MACA,IAAI,CAACd,YAAY,CAACe,KAAK,EAAE;MAEzB,MAAMf,YAAY,CAACe,KAAK,CAACC,QAAQ,CAAC,MAAOC,KAAK,IAAK;QACjD,IAAIA,KAAK,EAAE;UACT,IAAI;YACFJ,OAAO,CAACE,KAAK,GAAG,IAAI;YACpB,MAAMd,KAAK,CAACiB,QAAQ,CAAC,YAAY,EAAEd,SAAS,CAAC;YAC7C,MAAMH,KAAK,CAACiB,QAAQ,CAAC,kBAAkB,CAAC;YAExCnB,SAAS,CAAC;cACRU,OAAO,EAAE,MAAM;cACfU,IAAI,EAAE;YACR,CAAC,CAAC;;YAEF;YACAjB,MAAM,CAACkB,IAAI,CAACjB,KAAK,CAACkB,KAAK,CAACC,QAAQ,IAAI,GAAG,CAAC;UAC1C,CAAC,CAAC,OAAOC,KAAK,EAAE;YACdxB,SAAS,CAACwB,KAAK,CAACA,KAAK,CAACd,OAAO,IAAI,UAAU,CAAC;UAC9C,CAAC,SAAS;YACRI,OAAO,CAACE,KAAK,GAAG,KAAK;UACvB;QACF,CAAC,MAAM;UACL,OAAO,KAAK;QACd;MACF,CAAC,CAAC;IACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}