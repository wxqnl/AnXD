{"version":3,"file":"js/316.4237866f.js","mappings":"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","sources":["webpack://daijia-admin/./src/pages/order/OrderComment.vue","webpack://daijia-admin/./src/pages/order/OrderComment.vue?6065","webpack://daijia-admin/./src/api/order.js"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card class=\"search-card\">\n      <el-form :model=\"queryParams\" ref=\"queryForm\" :inline=\"true\" class=\"search-form\">\n        <el-form-item label=\"订单号\" prop=\"orderNo\">\n          <el-input v-model=\"queryParams.orderNo\" placeholder=\"请输入订单号\" clearable />\n        </el-form-item>\n        <el-form-item label=\"客户姓名\" prop=\"customerName\">\n          <el-input v-model=\"queryParams.customerName\" placeholder=\"请输入客户姓名\" clearable />\n        </el-form-item>\n        <el-form-item label=\"评分\" prop=\"score\">\n          <el-select v-model=\"queryParams.score\" placeholder=\"请选择评分\" clearable>\n            <el-option label=\"1星\" :value=\"1\" />\n            <el-option label=\"2星\" :value=\"2\" />\n            <el-option label=\"3星\" :value=\"3\" />\n            <el-option label=\"4星\" :value=\"4\" />\n            <el-option label=\"5星\" :value=\"5\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\n          <el-button @click=\"resetQuery\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\n    <el-card>\n      <template #header>\n        <div class=\"card-header\">\n          <span>评价列表</span>\n        </div>\n      </template>\n      \n      <el-table v-loading=\"loading\" :data=\"commentList\" border>\n        <el-table-column type=\"index\" label=\"#\" width=\"50\" />\n        <el-table-column prop=\"orderNo\" label=\"订单号\" width=\"180\" />\n        <el-table-column prop=\"customerName\" label=\"客户姓名\" />\n        <el-table-column prop=\"driverName\" label=\"司机姓名\" />\n        <el-table-column prop=\"score\" label=\"评分\">\n          <template #default=\"scope\">\n            <el-rate v-model=\"scope.row.score\" disabled />\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"content\" label=\"评价内容\" show-overflow-tooltip />\n        <el-table-column prop=\"createTime\" label=\"评价时间\" width=\"160\" />\n        <el-table-column prop=\"replyContent\" label=\"回复内容\" show-overflow-tooltip />\n        <el-table-column label=\"操作\" width=\"120\">\n          <template #default=\"scope\">\n            <el-button type=\"primary\" link @click=\"handleReply(scope.row)\" v-if=\"!scope.row.replyContent\">回复</el-button>\n            <el-button type=\"info\" link @click=\"handleDetail(scope.row)\">详情</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <el-pagination\n        v-if=\"total > 0\"\n        v-model:current-page=\"queryParams.pageNum\"\n        v-model:page-size=\"queryParams.pageSize\"\n        :page-sizes=\"[10, 20, 50, 100]\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      />\n    </el-card>\n\n    <!-- 回复评价对话框 -->\n    <el-dialog title=\"回复评价\" v-model=\"replyDialogVisible\" width=\"500px\">\n      <el-form ref=\"replyFormRef\" :model=\"replyForm\" :rules=\"replyRules\" label-width=\"80px\">\n        <el-form-item label=\"订单号\">\n          <el-input v-model=\"replyForm.orderNo\" disabled />\n        </el-form-item>\n        <el-form-item label=\"客户评价\">\n          <el-input v-model=\"replyForm.content\" type=\"textarea\" disabled :rows=\"3\" />\n        </el-form-item>\n        <el-form-item label=\"回复内容\" prop=\"replyContent\">\n          <el-input v-model=\"replyForm.replyContent\" type=\"textarea\" placeholder=\"请输入回复内容\" :rows=\"3\" />\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <div class=\"dialog-footer\">\n          <el-button @click=\"replyDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitReply\">确认</el-button>\n        </div>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { getOrderCommentList, getCommentByOrderId, updateComment } from '@/api/order'\n\n// 查询参数\nconst queryParams = reactive({\n  pageNum: 1,\n  pageSize: 10,\n  customerId: undefined,\n  driverId: undefined,\n  rate: undefined,\n  status: undefined\n})\n\n// 表格数据和状态\nconst commentList = ref([])\nconst loading = ref(false)\nconst total = ref(0)\n\n// 回复对话框\nconst replyDialogVisible = ref(false)\nconst replyFormRef = ref(null)\nconst replyForm = reactive({\n  id: undefined,\n  orderId: undefined,\n  content: '',\n  replyContent: ''\n})\n\n// 表单验证规则\nconst replyRules = {\n  replyContent: [\n    { required: true, message: '请输入回复内容', trigger: 'blur' },\n    { min: 1, max: 200, message: '长度在 1 到 200 个字符', trigger: 'blur' }\n  ]\n}\n\n// 获取评价列表\nconst getList = async () => {\n  try {\n    loading.value = true\n    const res = await getOrderCommentList(queryParams)\n    console.log('订单评价响应:', res)\n    commentList.value = res.data.items || []\n    total.value = res.data.total || 0\n  } catch (error) {\n    console.error('获取评价列表失败', error)\n  } finally {\n    loading.value = false\n  }\n}\n\n// 查询按钮\nconst handleQuery = () => {\n  queryParams.pageNum = 1\n  getList()\n}\n\n// 重置查询\nconst resetQuery = () => {\n  queryParams.customerId = undefined\n  queryParams.driverId = undefined\n  queryParams.rate = undefined\n  queryParams.status = undefined\n  queryParams.pageNum = 1\n  getList()\n}\n\n// 查看详情\nconst handleDetail = async (row) => {\n  try {\n    const res = await getCommentByOrderId(row.orderId)\n    ElMessage.info(`查看评价详情: ${row.orderNo || row.orderId}`)\n    console.log('评价详情:', res.data)\n  } catch (error) {\n    ElMessage.error('获取详情失败')\n  }\n}\n\n// 回复评价\nconst handleReply = (row) => {\n  replyForm.id = row.id\n  replyForm.orderId = row.orderId\n  replyForm.content = row.content\n  replyForm.replyContent = ''\n  replyDialogVisible.value = true\n}\n\n// 提交回复\nconst submitReply = async () => {\n  if (!replyFormRef.value) return\n  \n  await replyFormRef.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        await updateComment({\n          id: replyForm.id,\n          orderId: replyForm.orderId,\n          replyContent: replyForm.replyContent\n        })\n        ElMessage.success('回复成功')\n        replyDialogVisible.value = false\n        getList()\n      } catch (error) {\n        ElMessage.error('回复失败')\n      }\n    }\n  })\n}\n\n// 分页操作\nconst handleSizeChange = (size) => {\n  queryParams.pageSize = size\n  getList()\n}\n\nconst handleCurrentChange = (page) => {\n  queryParams.pageNum = page\n  getList()\n}\n\n// 页面加载时获取数据\nonMounted(() => {\n  getList()\n})\n</script>\n\n<style scoped>\n.app-container {\n  padding: 20px;\n}\n\n.search-card {\n  margin-bottom: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.el-pagination {\n  margin-top: 20px;\n  text-align: right;\n}\n</style> ","import script from \"./OrderComment.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./OrderComment.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./OrderComment.vue?vue&type=style&index=0&id=196f657b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-196f657b\"]])\n\nexport default __exports__","import request from '@/utils/request'\n\n// ========== 订单相关接口 ==========\n\n// 获取订单列表\nexport function getOrderList(params) {\n  return request({\n    url: '/order/getOrderInfo',\n    method: 'post',\n    params\n  })\n}\n\n// 获取订单详情\nexport function getOrderByOrderNo(orderNo) {\n  return request({\n    url: '/order/getByOrderNo',\n    method: 'post',\n    params: { orderNo }\n  })\n}\n\n// 创建订单\nexport function createOrder(data) {\n  return request({\n    url: '/order/add',\n    method: 'post',\n    data\n  })\n}\n\n// 更新订单\nexport function updateOrder(data) {\n  return request({\n    url: '/order/update',\n    method: 'post',\n    data\n  })\n}\n\n// 删除订单\nexport function deleteOrder(orderNo) {\n  return request({\n    url: '/order/delete',\n    method: 'post',\n    params: { orderNo }\n  })\n}\n\n// ========== 订单评价相关接口 ==========\n\n// 获取订单评价列表\nexport function getOrderCommentList(params) {\n  return request({\n    url: '/orderComment/list',\n    method: 'post',\n    params\n  })\n}\n\n// 根据订单ID获取评价\nexport function getCommentByOrderId(orderId) {\n  return request({\n    url: '/orderComment/getByOrderId',\n    method: 'get',\n    params: { orderId }\n  })\n}\n\n// 添加订单评价\nexport function addComment(data) {\n  return request({\n    url: '/orderComment/add',\n    method: 'post',\n    data\n  })\n}\n\n// 更新订单评价\nexport function updateComment(data) {\n  return request({\n    url: '/orderComment/update',\n    method: 'post',\n    data\n  })\n}\n\n// 删除订单评价\nexport function deleteComment(orderId) {\n  return request({\n    url: '/orderComment/delete',\n    method: 'post',\n    params: { orderId }\n  })\n}\n\n// 获取订单反馈信息\nexport function getOrderFeedback(orderId) {\n  return request({\n    url: '/feedback/getFeed',\n    method: 'get',\n    params: { orderId }\n  })\n} "],"names":["queryParams","reactive","pageNum","pageSize","customerId","undefined","driverId","rate","status","commentList","ref","loading","total","replyDialogVisible","replyFormRef","replyForm","id","orderId","content","replyContent","replyRules","required","message","trigger","min","max","getList","async","value","res","getOrderCommentList","console","log","data","items","error","handleQuery","resetQuery","handleDetail","getCommentByOrderId","row","ElMessage","info","orderNo","handleReply","submitReply","validate","valid","updateComment","success","handleSizeChange","size","handleCurrentChange","page","onMounted","__exports__","getOrderList","params","request","url","method","getOrderByOrderNo","updateOrder","getOrderFeedback"],"sourceRoot":""}