"use strict";(self["webpackChunkdaijia_admin"]=self["webpackChunkdaijia_admin"]||[]).push([[316],{2316:(e,l,a)=>{a.r(l),a.d(l,{default:()=>s});var o=a(6768),r=a(144),t=a(1219),d=a(4180);const u={class:"app-container"},n={class:"dialog-footer"},p={__name:"OrderComment",setup(e){const l=(0,r.Kh)({pageNum:1,pageSize:10,customerId:void 0,driverId:void 0,rate:void 0,status:void 0}),a=(0,r.KR)([]),p=(0,r.KR)(!1),i=(0,r.KR)(0),m=(0,r.KR)(!1),s=(0,r.KR)(null),c=(0,r.Kh)({id:void 0,orderId:void 0,content:"",replyContent:""}),b={replyContent:[{required:!0,message:"请输入回复内容",trigger:"blur"},{min:1,max:200,message:"长度在 1 到 200 个字符",trigger:"blur"}]},g=async()=>{try{p.value=!0;const e=await(0,d.Au)(l);console.log("订单评价响应:",e),a.value=e.data.items||[],i.value=e.data.total||0}catch(e){console.error("获取评价列表失败",e)}finally{p.value=!1}},v=()=>{l.pageNum=1,g()},f=()=>{l.customerId=void 0,l.driverId=void 0,l.rate=void 0,l.status=void 0,l.pageNum=1,g()},k=async e=>{try{const l=await(0,d.aH)(e.orderId);t.nk.info(`查看评价详情: ${e.orderNo||e.orderId}`),console.log("评价详情:",l.data)}catch(l){t.nk.error("获取详情失败")}},F=e=>{c.id=e.id,c.orderId=e.orderId,c.content=e.content,c.replyContent="",m.value=!0},y=async()=>{s.value&&await s.value.validate((async e=>{if(e)try{await(0,d.vv)({id:c.id,orderId:c.orderId,replyContent:c.replyContent}),t.nk.success("回复成功"),m.value=!1,g()}catch(l){t.nk.error("回复失败")}}))},h=e=>{l.pageSize=e,g()},_=e=>{l.pageNum=e,g()};return(0,o.sV)((()=>{g()})),(e,r)=>{const t=(0,o.g2)("el-input"),d=(0,o.g2)("el-form-item"),g=(0,o.g2)("el-option"),C=(0,o.g2)("el-select"),V=(0,o.g2)("el-button"),w=(0,o.g2)("el-form"),N=(0,o.g2)("el-card"),I=(0,o.g2)("el-table-column"),U=(0,o.g2)("el-rate"),z=(0,o.g2)("el-table"),A=(0,o.g2)("el-pagination"),W=(0,o.g2)("el-dialog"),x=(0,o.gN)("loading");return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(N,{class:"search-card"},{default:(0,o.k6)((()=>[(0,o.bF)(w,{model:l,ref:"queryForm",inline:!0,class:"search-form"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{label:"订单号",prop:"orderNo"},{default:(0,o.k6)((()=>[(0,o.bF)(t,{modelValue:l.orderNo,"onUpdate:modelValue":r[0]||(r[0]=e=>l.orderNo=e),placeholder:"请输入订单号",clearable:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"客户姓名",prop:"customerName"},{default:(0,o.k6)((()=>[(0,o.bF)(t,{modelValue:l.customerName,"onUpdate:modelValue":r[1]||(r[1]=e=>l.customerName=e),placeholder:"请输入客户姓名",clearable:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"评分",prop:"score"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{modelValue:l.score,"onUpdate:modelValue":r[2]||(r[2]=e=>l.score=e),placeholder:"请选择评分",clearable:""},{default:(0,o.k6)((()=>[(0,o.bF)(g,{label:"1星",value:1}),(0,o.bF)(g,{label:"2星",value:2}),(0,o.bF)(g,{label:"3星",value:3}),(0,o.bF)(g,{label:"4星",value:4}),(0,o.bF)(g,{label:"5星",value:5})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(V,{type:"primary",onClick:v},{default:(0,o.k6)((()=>r[10]||(r[10]=[(0,o.eW)("查询")]))),_:1}),(0,o.bF)(V,{onClick:f},{default:(0,o.k6)((()=>r[11]||(r[11]=[(0,o.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),(0,o.bF)(N,null,{header:(0,o.k6)((()=>r[12]||(r[12]=[(0,o.Lk)("div",{class:"card-header"},[(0,o.Lk)("span",null,"评价列表")],-1)]))),default:(0,o.k6)((()=>[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(z,{data:a.value,border:""},{default:(0,o.k6)((()=>[(0,o.bF)(I,{type:"index",label:"#",width:"50"}),(0,o.bF)(I,{prop:"orderNo",label:"订单号",width:"180"}),(0,o.bF)(I,{prop:"customerName",label:"客户姓名"}),(0,o.bF)(I,{prop:"driverName",label:"司机姓名"}),(0,o.bF)(I,{prop:"score",label:"评分"},{default:(0,o.k6)((e=>[(0,o.bF)(U,{modelValue:e.row.score,"onUpdate:modelValue":l=>e.row.score=l,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.bF)(I,{prop:"content",label:"评价内容","show-overflow-tooltip":""}),(0,o.bF)(I,{prop:"createTime",label:"评价时间",width:"160"}),(0,o.bF)(I,{prop:"replyContent",label:"回复内容","show-overflow-tooltip":""}),(0,o.bF)(I,{label:"操作",width:"120"},{default:(0,o.k6)((e=>[e.row.replyContent?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(V,{key:0,type:"primary",link:"",onClick:l=>F(e.row)},{default:(0,o.k6)((()=>r[13]||(r[13]=[(0,o.eW)("回复")]))),_:2},1032,["onClick"])),(0,o.bF)(V,{type:"info",link:"",onClick:l=>k(e.row)},{default:(0,o.k6)((()=>r[14]||(r[14]=[(0,o.eW)("详情")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[x,p.value]]),i.value>0?((0,o.uX)(),(0,o.Wv)(A,{key:0,"current-page":l.pageNum,"onUpdate:currentPage":r[3]||(r[3]=e=>l.pageNum=e),"page-size":l.pageSize,"onUpdate:pageSize":r[4]||(r[4]=e=>l.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:i.value,onSizeChange:h,onCurrentChange:_},null,8,["current-page","page-size","total"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(W,{title:"回复评价",modelValue:m.value,"onUpdate:modelValue":r[9]||(r[9]=e=>m.value=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.bF)(V,{onClick:r[8]||(r[8]=e=>m.value=!1)},{default:(0,o.k6)((()=>r[15]||(r[15]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(V,{type:"primary",onClick:y},{default:(0,o.k6)((()=>r[16]||(r[16]=[(0,o.eW)("确认")]))),_:1})])])),default:(0,o.k6)((()=>[(0,o.bF)(w,{ref_key:"replyFormRef",ref:s,model:c,rules:b,"label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{label:"订单号"},{default:(0,o.k6)((()=>[(0,o.bF)(t,{modelValue:c.orderNo,"onUpdate:modelValue":r[5]||(r[5]=e=>c.orderNo=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"客户评价"},{default:(0,o.k6)((()=>[(0,o.bF)(t,{modelValue:c.content,"onUpdate:modelValue":r[6]||(r[6]=e=>c.content=e),type:"textarea",disabled:"",rows:3},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"回复内容",prop:"replyContent"},{default:(0,o.k6)((()=>[(0,o.bF)(t,{modelValue:c.replyContent,"onUpdate:modelValue":r[7]||(r[7]=e=>c.replyContent=e),type:"textarea",placeholder:"请输入回复内容",rows:3},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}};var i=a(1241);const m=(0,i.A)(p,[["__scopeId","data-v-196f657b"]]),s=m},4180:(e,l,a)=>{a.d(l,{$e:()=>t,Au:()=>u,WB:()=>i,aH:()=>n,iY:()=>d,n7:()=>r,vv:()=>p});var o=a(5720);function r(e){return(0,o.A)({url:"/order/getOrderInfo",method:"post",params:e})}function t(e){return(0,o.A)({url:"/order/getByOrderNo",method:"post",params:{orderNo:e}})}function d(e){return(0,o.A)({url:"/order/update",method:"post",data:e})}function u(e){return(0,o.A)({url:"/orderComment/list",method:"post",params:e})}function n(e){return(0,o.A)({url:"/orderComment/getByOrderId",method:"get",params:{orderId:e}})}function p(e){return(0,o.A)({url:"/orderComment/update",method:"post",data:e})}function i(e){return(0,o.A)({url:"/feedback/getFeed",method:"get",params:{orderId:e}})}}}]);
//# sourceMappingURL=316.4237866f.js.map