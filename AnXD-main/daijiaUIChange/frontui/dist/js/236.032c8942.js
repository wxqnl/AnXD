"use strict";(self["webpackChunkdaijia_admin"]=self["webpackChunkdaijia_admin"]||[]).push([[236],{3236:(e,a,l)=>{l.r(a),l.d(a,{default:()=>h});var o=l(6768),r=l(4232),t=l(144),d=l(1219),u=l(2933),n=l(5720);function i(e){return(0,n.A)({url:"/sysRole/list",method:"get",params:e})}function s(e){return(0,n.A)({url:"/sysRole/getById",method:"get",params:{id:e}})}function c(e){return(0,n.A)({url:"/sysRole/add",method:"post",data:e})}function p(e){return(0,n.A)({url:"/sysRole/update",method:"post",data:e})}function m(e){return(0,n.A)({url:"/sysRole/delete",method:"post",params:{id:e}})}const g={class:"app-container"},b={class:"card-header"},k={class:"dialog-footer"},v={__name:"SysRole",setup(e){const a=(0,t.Kh)({pageNum:1,pageSize:10,roleName:"",roleCode:""}),l=(0,t.KR)([]),n=(0,t.KR)(!1),v=(0,t.KR)(0),f=(0,t.KR)(!1),y=(0,t.KR)(!1),h=(0,o.EW)((()=>y.value?"编辑角色":"新增角色")),C=(0,t.KR)(null),F=(0,t.Kh)({id:void 0,roleName:"",roleCode:"",description:""}),_={roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],roleCode:[{required:!0,message:"角色编码不能为空",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],description:[{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}]},w=async()=>{try{n.value=!0;const e=await i(a);console.log("角色列表响应:",e),l.value=e.data.items||[],v.value=e.data.total||0}catch(e){console.error("获取角色列表失败",e),d.nk.error("获取角色列表失败")}finally{n.value=!1}},N=()=>{F.id=void 0,F.roleName="",F.roleCode="",F.description="",C.value&&C.value.resetFields()},R=()=>{y.value=!1,N(),f.value=!0},V=async e=>{y.value=!0,N();try{const a=await s(e.id);a&&a.data?(F.id=a.data.id,F.roleName=a.data.roleName,F.roleCode=a.data.roleCode,F.description=a.data.description):Object.assign(F,e),f.value=!0}catch(a){console.error("获取角色详情失败",a),d.nk.error("获取角色详情失败")}},x=e=>{u.s.confirm(`确定要删除角色 ${e.roleName} 吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await m(e.id),d.nk.success("删除成功"),w()}catch(a){console.error("删除角色失败",a),d.nk.error("删除失败")}})).catch((()=>{}))},W=()=>{C.value.validate((async e=>{if(e)try{y.value?(await p(F),d.nk.success("更新成功")):(await c(F),d.nk.success("添加成功")),f.value=!1,w()}catch(a){console.error("保存角色失败",a),d.nk.error("保存失败: "+(a.message||"未知错误"))}}))},z=e=>{a.pageSize=e,w()},K=e=>{a.pageNum=e,w()};return(0,o.sV)((()=>{w()})),(e,t)=>{const d=(0,o.g2)("el-button"),u=(0,o.g2)("el-table-column"),i=(0,o.g2)("el-tag"),s=(0,o.g2)("el-table"),c=(0,o.g2)("el-pagination"),p=(0,o.g2)("el-card"),m=(0,o.g2)("el-input"),y=(0,o.g2)("el-form-item"),w=(0,o.g2)("el-form"),N=(0,o.g2)("el-dialog"),A=(0,o.gN)("loading");return(0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(p,null,{header:(0,o.k6)((()=>[(0,o.Lk)("div",b,[t[6]||(t[6]=(0,o.Lk)("span",null,"角色管理",-1)),(0,o.bF)(d,{type:"primary",onClick:R},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.eW)("新增角色")]))),_:1})])])),default:(0,o.k6)((()=>[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(s,{data:l.value,border:""},{default:(0,o.k6)((()=>[(0,o.bF)(u,{type:"index",label:"#",width:"50"}),(0,o.bF)(u,{prop:"roleName",label:"角色名称"}),(0,o.bF)(u,{prop:"roleCode",label:"角色编码"}),(0,o.bF)(u,{prop:"description",label:"描述"}),(0,o.bF)(u,{prop:"status",label:"状态"},{default:(0,o.k6)((e=>[(0,o.bF)(i,{type:1===e.row.status?"success":"danger"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(1===e.row.status?"正常":"停用"),1)])),_:2},1032,["type"])])),_:1}),(0,o.bF)(u,{label:"操作",width:"200"},{default:(0,o.k6)((e=>[(0,o.bF)(d,{type:"primary",link:"",onClick:a=>V(e.row)},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("编辑")]))),_:2},1032,["onClick"]),(0,o.bF)(d,{type:"danger",link:"",onClick:a=>x(e.row)},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[A,n.value]]),v.value>0?((0,o.uX)(),(0,o.Wv)(c,{key:0,"current-page":a.pageNum,"page-size":a.pageSize,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:v.value,onSizeChange:z,onCurrentChange:K},null,8,["current-page","page-size","total"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(N,{title:h.value,modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=e=>f.value=e),width:"500px","close-on-click-modal":!1},{footer:(0,o.k6)((()=>[(0,o.Lk)("div",k,[(0,o.bF)(d,{onClick:t[3]||(t[3]=e=>f.value=!1)},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(d,{type:"primary",onClick:W},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("确定")]))),_:1})])])),default:(0,o.k6)((()=>[(0,o.bF)(w,{ref_key:"roleFormRef",ref:C,model:F,rules:_,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(y,{label:"角色名称",prop:"roleName"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:F.roleName,"onUpdate:modelValue":t[0]||(t[0]=e=>F.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(y,{label:"角色编码",prop:"roleCode"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:F.roleCode,"onUpdate:modelValue":t[1]||(t[1]=e=>F.roleCode=e),placeholder:"请输入角色编码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(y,{label:"描述",prop:"description"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{modelValue:F.description,"onUpdate:modelValue":t[2]||(t[2]=e=>F.description=e),type:"textarea",rows:3,placeholder:"请输入角色描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}};var f=l(1241);const y=(0,f.A)(v,[["__scopeId","data-v-cb1275aa"]]),h=y}}]);
//# sourceMappingURL=236.032c8942.js.map