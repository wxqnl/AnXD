"use strict";(self["webpackChunkdaijia_admin"]=self["webpackChunkdaijia_admin"]||[]).push([[130],{425:(e,a,l)=>{l.d(a,{Aj:()=>r,NV:()=>o,Ut:()=>d,V6:()=>n,xh:()=>u});var t=l(5720);function d(e){const a={pageSize:e?.pageSize||10,pageNum:e?.pageNum||1,...e};return(0,t.A)({url:"/sysDept/list",method:"get",params:a})}function r(e){return(0,t.A)({url:"/sysDept/getById",method:"get",params:{id:e}})}function u(e){return(0,t.A)({url:"/sysDept/add",method:"post",data:e})}function o(e){return(0,t.A)({url:"/sysDept/update",method:"post",data:e})}function n(e){return(0,t.A)({url:"/sysDept/delete",method:"post",params:{id:e}})}},6130:(e,a,l)=>{l.r(a),l.d(a,{default:()=>b});var t=l(6768),d=l(4232),r=l(144),u=l(1219),o=l(2933),n=l(425);const p={class:"app-container"},s={class:"card-header"},i={class:"dialog-footer"},m={__name:"SysDept",setup(e){const a=(0,r.KR)([]),l=(0,r.KR)([]),m=(0,r.KR)(!1),c=(0,r.KR)(0),g=(0,r.Kh)({pageNum:1,pageSize:10,name:"",leader:"",status:void 0}),b=(0,r.KR)(!1),k=(0,r.KR)(""),f=(0,r.KR)(null),h=(0,r.Kh)({id:void 0,parentId:0,name:"",leader:"",phone:"",sortValue:0,status:1}),v={name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],parentId:[{required:!0,message:"请选择上级部门",trigger:"change"}],sortValue:[{required:!0,message:"请输入排序",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},F=()=>{g.pageNum=1,g.pageSize=g.pageSize||10,w()},V=()=>{g.name="",g.leader="",g.status=void 0,g.pageNum=1,g.pageSize=10,w()},_=e=>{g.pageSize=e,w()},y=e=>{g.pageNum=e,w()},w=async()=>{try{m.value=!0;const e={pageSize:g.pageSize||10,pageNum:g.pageNum||1,name:g.name,leader:g.leader,status:g.status},t=await(0,n.Ut)(e);console.log("部门列表响应:",t),t.data&&t.data.items?(a.value=t.data.items||[],c.value=t.data.total||0,a.value=a.value.map((e=>({...e,parentId:e.parentId||0,children:[]}))),l.value=[{id:0,name:"顶级部门",parentId:-1}].concat(a.value.map((e=>({id:e.id,name:e.name,parentId:e.parentId}))))):(a.value=[],l.value=[{id:0,name:"顶级部门",parentId:-1}],c.value=0)}catch(e){console.error("获取部门列表失败",e),u.nk.error("获取部门列表失败："+(e.message||"未知错误"))}finally{m.value=!1}},z=()=>{h.id=void 0,h.parentId=0,h.name="",h.leader="",h.phone="",h.sortValue=0,h.status=1,(0,t.dY)((()=>{f.value?.resetFields()}))},C=()=>{z(),k.value="新增部门",b.value=!0},I=async e=>{z(),k.value="编辑部门",b.value=!0;try{const a=await(0,n.Aj)(e.id);a.data&&Object.assign(h,a.data)}catch(a){u.nk.error("获取部门信息失败")}},S=e=>{o.s.confirm(`确定要删除部门 ${e.name} 吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await(0,n.V6)(e.id),u.nk.success("删除成功"),w()}catch(a){u.nk.error("删除失败")}})).catch((()=>{}))},U=()=>{b.value=!1,z()},N=async()=>{f.value.validate((async e=>{if(e)try{h.id?(await(0,n.NV)(h),u.nk.success("修改部门成功")):(await(0,n.xh)(h),u.nk.success("新增部门成功")),b.value=!1,w()}catch(a){console.error("操作失败",a),u.nk.error("操作失败，请稍后重试")}}))};return(0,t.sV)((()=>{w()})),(e,r)=>{const u=(0,t.g2)("el-input"),o=(0,t.g2)("el-form-item"),n=(0,t.g2)("el-option"),w=(0,t.g2)("el-select"),z=(0,t.g2)("el-button"),W=(0,t.g2)("el-form"),x=(0,t.g2)("el-card"),K=(0,t.g2)("el-table-column"),A=(0,t.g2)("el-tag"),R=(0,t.g2)("el-table"),j=(0,t.g2)("el-pagination"),D=(0,t.g2)("el-tree-select"),q=(0,t.g2)("el-input-number"),B=(0,t.g2)("el-radio"),L=(0,t.g2)("el-radio-group"),X=(0,t.g2)("el-dialog"),T=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(x,{class:"search-card"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{model:g,ref:"queryForm",inline:!0,class:"search-form"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{label:"部门名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:g.name,"onUpdate:modelValue":r[0]||(r[0]=e=>g.name=e),placeholder:"请输入部门名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"负责人",prop:"leader"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:g.leader,"onUpdate:modelValue":r[1]||(r[1]=e=>g.leader=e),placeholder:"请输入负责人",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(w,{modelValue:g.status,"onUpdate:modelValue":r[2]||(r[2]=e=>g.status=e),placeholder:"请选择状态",clearable:""},{default:(0,t.k6)((()=>[(0,t.bF)(n,{label:"正常",value:1}),(0,t.bF)(n,{label:"停用",value:0})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(o,null,{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"primary",onClick:F},{default:(0,t.k6)((()=>r[12]||(r[12]=[(0,t.eW)("查询")]))),_:1}),(0,t.bF)(z,{onClick:V},{default:(0,t.k6)((()=>r[13]||(r[13]=[(0,t.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),(0,t.bF)(x,null,{header:(0,t.k6)((()=>[(0,t.Lk)("div",s,[r[15]||(r[15]=(0,t.Lk)("span",null,"部门管理",-1)),(0,t.bF)(z,{type:"primary",onClick:C},{default:(0,t.k6)((()=>r[14]||(r[14]=[(0,t.eW)("新增部门")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(R,{data:a.value,"row-key":"id",border:"","tree-props":{children:"children"},"default-expand-all":!0},{default:(0,t.k6)((()=>[(0,t.bF)(K,{prop:"name",label:"部门名称"}),(0,t.bF)(K,{prop:"leader",label:"负责人"}),(0,t.bF)(K,{prop:"phone",label:"联系电话"}),(0,t.bF)(K,{prop:"status",label:"状态",width:"80"},{default:(0,t.k6)((e=>[(0,t.bF)(A,{type:1===e.row.status?"success":"danger"},{default:(0,t.k6)((()=>[(0,t.eW)((0,d.v_)(1===e.row.status?"正常":"停用"),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(K,{label:"操作",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(z,{type:"primary",link:"",onClick:a=>I(e.row)},{default:(0,t.k6)((()=>r[16]||(r[16]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(z,{type:"danger",link:"",onClick:a=>S(e.row)},{default:(0,t.k6)((()=>r[17]||(r[17]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[T,m.value]]),c.value>0?((0,t.uX)(),(0,t.Wv)(j,{key:0,"current-page":g.pageNum,"onUpdate:currentPage":r[3]||(r[3]=e=>g.pageNum=e),"page-size":g.pageSize,"onUpdate:pageSize":r[4]||(r[4]=e=>g.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:c.value,onSizeChange:_,onCurrentChange:y},null,8,["current-page","page-size","total"])):(0,t.Q3)("",!0)])),_:1}),(0,t.bF)(X,{title:k.value,modelValue:b.value,"onUpdate:modelValue":r[11]||(r[11]=e=>b.value=e),width:"500px","append-to-body":"","close-on-click-modal":!1},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",i,[(0,t.bF)(z,{onClick:U},{default:(0,t.k6)((()=>r[20]||(r[20]=[(0,t.eW)("取 消")]))),_:1}),(0,t.bF)(z,{type:"primary",onClick:N},{default:(0,t.k6)((()=>r[21]||(r[21]=[(0,t.eW)("确 定")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(W,{ref_key:"deptFormRef",ref:f,model:h,rules:v,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{label:"上级部门",prop:"parentId"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.parentId,"onUpdate:modelValue":r[5]||(r[5]=e=>h.parentId=e),data:l.value,"render-after-expand":!1,"node-key":"id",props:{label:"name",value:"id",children:"children"},placeholder:"请选择上级部门","check-strictly":"",clearable:""},null,8,["modelValue","data"])])),_:1}),(0,t.bF)(o,{label:"部门名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:h.name,"onUpdate:modelValue":r[6]||(r[6]=e=>h.name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"负责人",prop:"leader"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:h.leader,"onUpdate:modelValue":r[7]||(r[7]=e=>h.leader=e),placeholder:"请输入负责人"},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"联系电话",prop:"phone"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:h.phone,"onUpdate:modelValue":r[8]||(r[8]=e=>h.phone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"排序",prop:"sortValue"},{default:(0,t.k6)((()=>[(0,t.bF)(q,{modelValue:h.sortValue,"onUpdate:modelValue":r[9]||(r[9]=e=>h.sortValue=e),min:0,max:999,"controls-position":"right"},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(L,{modelValue:h.status,"onUpdate:modelValue":r[10]||(r[10]=e=>h.status=e)},{default:(0,t.k6)((()=>[(0,t.bF)(B,{label:1},{default:(0,t.k6)((()=>r[18]||(r[18]=[(0,t.eW)("正常")]))),_:1}),(0,t.bF)(B,{label:0},{default:(0,t.k6)((()=>r[19]||(r[19]=[(0,t.eW)("停用")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}};var c=l(1241);const g=(0,c.A)(m,[["__scopeId","data-v-3c1b736c"]]),b=g}}]);
//# sourceMappingURL=130.6e728bbf.js.map