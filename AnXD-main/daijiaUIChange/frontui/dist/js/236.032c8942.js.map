{"version":3,"file":"js/236.032c8942.js","mappings":"8MAGO,SAASA,EAAYC,GAC1B,OAAOC,EAAAA,EAAAA,GAAQ,CACbC,IAAK,gBACLC,OAAQ,MACRH,UAEJ,CAGO,SAASI,EAAYC,GAC1B,OAAOJ,EAAAA,EAAAA,GAAQ,CACbC,IAAK,mBACLC,OAAQ,MACRH,OAAQ,CAAEK,OAEd,CAGO,SAASC,EAAQC,GACtB,OAAON,EAAAA,EAAAA,GAAQ,CACbC,IAAK,eACLC,OAAQ,OACRI,QAEJ,CAGO,SAASC,EAAWD,GACzB,OAAON,EAAAA,EAAAA,GAAQ,CACbC,IAAK,kBACLC,OAAQ,OACRI,QAEJ,CAGO,SAASE,EAAWJ,GACzB,OAAOJ,EAAAA,EAAAA,GAAQ,CACbC,IAAK,kBACLC,OAAQ,OACRH,OAAQ,CAAEK,OAEd,C,+GCyCA,MAAMK,GAAcC,EAAAA,EAAAA,IAAS,CAC3BC,QAAS,EACTC,SAAU,GACVC,SAAU,GACVC,SAAU,KAINC,GAAWC,EAAAA,EAAAA,IAAI,IACfC,GAAUD,EAAAA,EAAAA,KAAI,GACdE,GAAQF,EAAAA,EAAAA,IAAI,GAGZG,GAAgBH,EAAAA,EAAAA,KAAI,GACpBI,GAASJ,EAAAA,EAAAA,KAAI,GACbK,GAAcC,EAAAA,EAAAA,KAAS,IAAMF,EAAOG,MAAQ,OAAS,SAGrDC,GAAcR,EAAAA,EAAAA,IAAI,MAClBS,GAAWf,EAAAA,EAAAA,IAAS,CACxBN,QAAIsB,EACJb,SAAU,GACVC,SAAU,GACVa,YAAa,KAITC,EAAQ,CACZf,SAAU,CACR,CAAEgB,UAAU,EAAMC,QAAS,WAAYC,QAAS,QAChD,CAAEC,IAAK,EAAGC,IAAK,GAAIH,QAAS,iBAAkBC,QAAS,SAEzDjB,SAAU,CACR,CAAEe,UAAU,EAAMC,QAAS,WAAYC,QAAS,QAChD,CAAEC,IAAK,EAAGC,IAAK,GAAIH,QAAS,iBAAkBC,QAAS,SAEzDJ,YAAa,CACX,CAAEM,IAAK,IAAKH,QAAS,iBAAkBC,QAAS,UAK9CG,EAAUC,UACd,IACElB,EAAQM,OAAQ,EAChB,MAAMa,QAAYtC,EAAYW,GAC9B4B,QAAQC,IAAI,UAAWF,GACvBrB,EAASQ,MAAQa,EAAI9B,KAAKiC,OAAS,GACnCrB,EAAMK,MAAQa,EAAI9B,KAAKY,OAAS,CAClC,CAAE,MAAOsB,GACPH,QAAQG,MAAM,WAAYA,GAC1BC,EAAAA,GAAUD,MAAM,WAClB,CAAE,QACAvB,EAAQM,OAAQ,CAClB,GAIImB,EAAYA,KAChBjB,EAASrB,QAAKsB,EACdD,EAASZ,SAAW,GACpBY,EAASX,SAAW,GACpBW,EAASE,YAAc,GAGnBH,EAAYD,OACdC,EAAYD,MAAMoB,aACpB,EAIIC,EAAYA,KAChBxB,EAAOG,OAAQ,EACfmB,IACAvB,EAAcI,OAAQ,CAAG,EAIrBsB,EAAaV,UACjBf,EAAOG,OAAQ,EACfmB,IAEA,IAEE,MAAMN,QAAYjC,EAAY2C,EAAI1C,IAC9BgC,GAAOA,EAAI9B,MAEbmB,EAASrB,GAAKgC,EAAI9B,KAAKF,GACvBqB,EAASZ,SAAWuB,EAAI9B,KAAKO,SAC7BY,EAASX,SAAWsB,EAAI9B,KAAKQ,SAC7BW,EAASE,YAAcS,EAAI9B,KAAKqB,aAGhCoB,OAAOC,OAAOvB,EAAUqB,GAG1B3B,EAAcI,OAAQ,CACxB,CAAE,MAAOiB,GACPH,QAAQG,MAAM,WAAYA,GAC1BC,EAAAA,GAAUD,MAAM,WAClB,GAIIS,EAAgBH,IACpBI,EAAAA,EAAaC,QAAQ,WAAWL,EAAIjC,cAAe,KAAM,CACvDuC,kBAAmB,KACnBC,iBAAkB,KAClBC,KAAM,YACLC,MAAKpB,UACN,UACQ3B,EAAWsC,EAAI1C,IACrBqC,EAAAA,GAAUe,QAAQ,QAClBtB,GACF,CAAE,MAAOM,GACPH,QAAQG,MAAM,SAAUA,GACxBC,EAAAA,GAAUD,MAAM,OAClB,KACCiB,OAAM,QAAS,EAIdC,EAAaA,KACjBlC,EAAYD,MAAMoC,UAASxB,UACzB,GAAIyB,EACF,IACMxC,EAAOG,aAEHhB,EAAWkB,GACjBgB,EAAAA,GAAUe,QAAQ,gBAGZnD,EAAQoB,GACdgB,EAAAA,GAAUe,QAAQ,SAGpBrC,EAAcI,OAAQ,EACtBW,GACF,CAAE,MAAOM,GACPH,QAAQG,MAAM,SAAUA,GACxBC,EAAAA,GAAUD,MAAM,UAAYA,EAAMV,SAAW,QAC/C,CACF,GACA,EAIE+B,EAAoBC,IACxBrD,EAAYG,SAAWkD,EACvB5B,GAAS,EAGL6B,EAAuBC,IAC3BvD,EAAYE,QAAUqD,EACtB9B,GAAS,E,OAIX+B,EAAAA,EAAAA,KAAU,KACR/B,GAAS,I,s2FC/OX,MAAMgC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,G","sources":["webpack://daijia-admin/./src/api/role.js","webpack://daijia-admin/./src/pages/system/SysRole.vue","webpack://daijia-admin/./src/pages/system/SysRole.vue?cfa7"],"sourcesContent":["import request from '@/utils/request'\n\n// 获取角色列表\nexport function getRoleList(params) {\n  return request({\n    url: '/sysRole/list',\n    method: 'get',\n    params\n  })\n}\n\n// 获取角色详情\nexport function getRoleById(id) {\n  return request({\n    url: '/sysRole/getById',\n    method: 'get',\n    params: { id }\n  })\n}\n\n// 添加角色\nexport function addRole(data) {\n  return request({\n    url: '/sysRole/add',\n    method: 'post',\n    data\n  })\n}\n\n// 更新角色\nexport function updateRole(data) {\n  return request({\n    url: '/sysRole/update',\n    method: 'post',\n    data\n  })\n}\n\n// 删除角色\nexport function deleteRole(id) {\n  return request({\n    url: '/sysRole/delete',\n    method: 'post',\n    params: { id }\n  })\n} ","<template>\n  <div class=\"app-container\">\n    <el-card>\n      <template #header>\n        <div class=\"card-header\">\n          <span>角色管理</span>\n          <el-button type=\"primary\" @click=\"handleAdd\">新增角色</el-button>\n        </div>\n      </template>\n      \n      <el-table v-loading=\"loading\" :data=\"roleList\" border>\n        <el-table-column type=\"index\" label=\"#\" width=\"50\" />\n        <el-table-column prop=\"roleName\" label=\"角色名称\" />\n        <el-table-column prop=\"roleCode\" label=\"角色编码\" />\n        <el-table-column prop=\"description\" label=\"描述\" />\n        <el-table-column prop=\"status\" label=\"状态\">\n          <template #default=\"scope\">\n            <el-tag :type=\"scope.row.status === 1 ? 'success' : 'danger'\">\n              {{ scope.row.status === 1 ? '正常' : '停用' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"200\">\n          <template #default=\"scope\">\n            <el-button type=\"primary\" link @click=\"handleEdit(scope.row)\">编辑</el-button>\n            <el-button type=\"danger\" link @click=\"handleDelete(scope.row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <el-pagination\n        v-if=\"total > 0\"\n        :current-page=\"queryParams.pageNum\"\n        :page-size=\"queryParams.pageSize\"\n        :page-sizes=\"[10, 20, 50, 100]\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      />\n    </el-card>\n    \n    <!-- 角色编辑/新增对话框 -->\n    <el-dialog \n      :title=\"dialogTitle\" \n      v-model=\"dialogVisible\" \n      width=\"500px\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-form \n        ref=\"roleFormRef\" \n        :model=\"roleForm\" \n        :rules=\"rules\" \n        label-width=\"100px\"\n      >\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"roleForm.roleName\" placeholder=\"请输入角色名称\" />\n        </el-form-item>\n        <el-form-item label=\"角色编码\" prop=\"roleCode\">\n          <el-input v-model=\"roleForm.roleCode\" placeholder=\"请输入角色编码\" />\n        </el-form-item>\n        <el-form-item label=\"描述\" prop=\"description\">\n          <el-input \n            v-model=\"roleForm.description\" \n            type=\"textarea\" \n            :rows=\"3\"\n            placeholder=\"请输入角色描述\" \n          />\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <div class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\n        </div>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted, computed } from 'vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { getRoleList, addRole, updateRole, deleteRole, getRoleById } from '@/api/role'\n\n// 查询参数\nconst queryParams = reactive({\n  pageNum: 1,\n  pageSize: 10,\n  roleName: '',\n  roleCode: ''\n})\n\n// 表格数据和状态\nconst roleList = ref([])\nconst loading = ref(false)\nconst total = ref(0)\n\n// 对话框相关\nconst dialogVisible = ref(false)\nconst isEdit = ref(false)\nconst dialogTitle = computed(() => isEdit.value ? '编辑角色' : '新增角色')\n\n// 表单相关\nconst roleFormRef = ref(null)\nconst roleForm = reactive({\n  id: undefined,\n  roleName: '',\n  roleCode: '',\n  description: ''\n})\n\n// 表单验证规则\nconst rules = {\n  roleName: [\n    { required: true, message: '角色名称不能为空', trigger: 'blur' },\n    { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\n  ],\n  roleCode: [\n    { required: true, message: '角色编码不能为空', trigger: 'blur' },\n    { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\n  ],\n  description: [\n    { max: 200, message: '长度不能超过 200 个字符', trigger: 'blur' }\n  ]\n}\n\n// 获取角色列表\nconst getList = async () => {\n  try {\n    loading.value = true\n    const res = await getRoleList(queryParams)\n    console.log('角色列表响应:', res)\n    roleList.value = res.data.items || []\n    total.value = res.data.total || 0\n  } catch (error) {\n    console.error('获取角色列表失败', error)\n    ElMessage.error('获取角色列表失败')\n  } finally {\n    loading.value = false\n  }\n}\n\n// 重置表单\nconst resetForm = () => {\n  roleForm.id = undefined\n  roleForm.roleName = ''\n  roleForm.roleCode = ''\n  roleForm.description = ''\n  \n  // 如果表单ref存在，重置校验状态\n  if (roleFormRef.value) {\n    roleFormRef.value.resetFields()\n  }\n}\n\n// 新增角色\nconst handleAdd = () => {\n  isEdit.value = false\n  resetForm()\n  dialogVisible.value = true\n}\n\n// 编辑角色\nconst handleEdit = async (row) => {\n  isEdit.value = true\n  resetForm()\n  \n  try {\n    // 获取最新的角色详情\n    const res = await getRoleById(row.id)\n    if (res && res.data) {\n      // 填充表单数据\n      roleForm.id = res.data.id\n      roleForm.roleName = res.data.roleName\n      roleForm.roleCode = res.data.roleCode\n      roleForm.description = res.data.description\n    } else {\n      // 如果获取详情失败，使用表格行数据\n      Object.assign(roleForm, row)\n    }\n    \n    dialogVisible.value = true\n  } catch (error) {\n    console.error('获取角色详情失败', error)\n    ElMessage.error('获取角色详情失败')\n  }\n}\n\n// 删除角色\nconst handleDelete = (row) => {\n  ElMessageBox.confirm(`确定要删除角色 ${row.roleName} 吗?`, '提示', {\n    confirmButtonText: '确定',\n    cancelButtonText: '取消',\n    type: 'warning'\n  }).then(async () => {\n    try {\n      await deleteRole(row.id)\n      ElMessage.success('删除成功')\n      getList()\n    } catch (error) {\n      console.error('删除角色失败', error)\n      ElMessage.error('删除失败')\n    }\n  }).catch(() => {})\n}\n\n// 提交表单\nconst submitForm = () => {\n  roleFormRef.value.validate(async (valid) => {\n    if (valid) {\n      try {\n        if (isEdit.value) {\n          // 编辑角色\n          await updateRole(roleForm)\n          ElMessage.success('更新成功')\n        } else {\n          // 新增角色\n          await addRole(roleForm)\n          ElMessage.success('添加成功')\n        }\n        \n        dialogVisible.value = false\n        getList() // 刷新列表\n      } catch (error) {\n        console.error('保存角色失败', error)\n        ElMessage.error('保存失败: ' + (error.message || '未知错误'))\n      }\n    }\n  })\n}\n\n// 分页操作\nconst handleSizeChange = (size) => {\n  queryParams.pageSize = size\n  getList()\n}\n\nconst handleCurrentChange = (page) => {\n  queryParams.pageNum = page\n  getList()\n}\n\n// 页面加载时获取数据\nonMounted(() => {\n  getList()\n})\n</script>\n\n<style scoped>\n.app-container {\n  padding: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.el-pagination {\n  margin-top: 20px;\n  text-align: right;\n}\n</style> ","import script from \"./SysRole.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SysRole.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SysRole.vue?vue&type=style&index=0&id=cb1275aa&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-cb1275aa\"]])\n\nexport default __exports__"],"names":["getRoleList","params","request","url","method","getRoleById","id","addRole","data","updateRole","deleteRole","queryParams","reactive","pageNum","pageSize","roleName","roleCode","roleList","ref","loading","total","dialogVisible","isEdit","dialogTitle","computed","value","roleFormRef","roleForm","undefined","description","rules","required","message","trigger","min","max","getList","async","res","console","log","items","error","ElMessage","resetForm","resetFields","handleAdd","handleEdit","row","Object","assign","handleDelete","ElMessageBox","confirm","confirmButtonText","cancelButtonText","type","then","success","catch","submitForm","validate","valid","handleSizeChange","size","handleCurrentChange","page","onMounted","__exports__"],"sourceRoot":""}